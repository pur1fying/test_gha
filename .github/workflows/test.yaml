name: test_build android lib workflow
on:
    workflow_dispatch:
      inputs:
        create_release:
          description: 'Create new release'
          required: true
          type: boolean
    push:
        branches:
        - main
    pull_request:
        branches:
        - main

jobs:
  Windows-latest-cmake-x64:
    name: â€˜Test windows x64'
    runs-on: windows-latest
    steps:
      - name: Clone
        id: checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Run Test
        id: run_test
        shell: cmd
        run: |
          cd D:\a\test_gha\test_gha
          icacls "build\bin\BAAS_ocr_server.exe" /grant Everyone:(F)
          echo "Run Test"
          .\build\bin\BAAS_ocr_server.exe
          .\build\bin\helloworld.exe
          echo "Exit code: $?"
          echo "Run Test Done"
          python -m pip install --upgrade pip
          python -m pip install -r apps/ocr_server/test/requirements.txt
          python -m unittest discover -s .\apps\ocr_server\test -p "*.py"